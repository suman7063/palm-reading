<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§π‡§∏‡•ç‡§§ ‡§∞‡•á‡§ñ‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® - AI Palm Reading</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Spectral:wght@300;400;600&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        :root {
            --primary: #0f172a;
            --secondary: #1e293b;
            --mint: #7DD3C0;
            --purple: #9B7FDB;
            --blue: #60A5FA;
            --text: #f1f5f9;
            --text-dim: #94a3b8;
            --card-bg: rgba(30, 41, 59, 0.7);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Spectral', serif;
            background: var(--primary);
            color: var(--text);
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .animate-twinkle {
            animation: twinkle 3s infinite;
        }

        .animate-fadeIn {
            animation: fadeIn 0.8s ease-out;
        }

        .animate-slideDown {
            animation: slideDown 0.3s ease-out;
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        .font-cinzel {
            font-family: 'Cinzel', serif;
        }

        .font-spectral {
            font-family: 'Spectral', serif;
        }

        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--mint);
            border-radius: 5px;
        }

        .bg-gradient-text {
            background: linear-gradient(135deg, var(--mint) 0%, var(--blue) 50%, var(--purple) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0f172a',
                        secondary: '#1e293b',
                        mint: '#7DD3C0',
                        purple: '#9B7FDB',
                        blue: '#60A5FA',
                        text: '#f1f5f9',
                        'text-dim': '#94a3b8',
                        'card-bg': 'rgba(30, 41, 59, 0.7)',
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // Lucide React Icons (simplified inline versions)
        const Camera = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                <circle cx="12" cy="13" r="4"/>
            </svg>
        );

        const Upload = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17 8 12 3 7 8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
        );

        const Sparkles = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/>
                <path d="M5 3v4"/>
                <path d="M19 17v4"/>
                <path d="M3 5h4"/>
                <path d="M17 19h4"/>
            </svg>
        );

        const RotateCcw = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                <path d="M3 3v5h5"/>
            </svg>
        );

        const X = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
        );

        const Globe = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <line x1="2" y1="12" x2="22" y2="12"/>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
        );

        const Loader2 = ({ size = 24, className = "" }) => (
            <svg className={`${className} animate-spin`} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
            </svg>
        );

        // Translations
        const translations = {
            hi: {
                title: '‡§π‡§∏‡•ç‡§§ ‡§∞‡•á‡§ñ‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®',
                subtitle: 'AI ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ö‡§™‡§®‡•Ä ‡§ï‡§ø‡§∏‡•ç‡§Æ‡§§ ‡§ï‡•Ä ‡§∞‡•á‡§ñ‡§æ‡§è‡§Ç ‡§ú‡§æ‡§®‡•á‡§Ç',
                cameraTitle: '‡§ï‡•à‡§Æ‡§∞‡§æ ‡§∏‡•á ‡§∏‡•ç‡§ï‡•à‡§® ‡§ï‡§∞‡•á‡§Ç',
                cameraDesc: '‡§Ö‡§™‡§®‡§æ ‡§π‡§æ‡§• ‡§ï‡•à‡§Æ‡§∞‡•á ‡§ï‡•á ‡§∏‡§æ‡§Æ‡§®‡•á ‡§∞‡§ñ‡•á‡§Ç',
                uploadTitle: '‡§´‡•ã‡§ü‡•ã ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç',
                uploadDesc: '‡§Ö‡§™‡§®‡•á ‡§π‡§æ‡§• ‡§ï‡•Ä ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç',
                captureBtn: '‡§´‡•ã‡§ü‡•ã ‡§≤‡•á‡§Ç',
                analyzeBtn: '‡§π‡§∏‡•ç‡§§‡§∞‡•á‡§ñ‡§æ ‡§™‡§¢‡§º‡•á‡§Ç',
                cancelBtn: '‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç',
                resetBtn: '‡§´‡§ø‡§∞ ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç',
                clickHere: '‡§Ø‡§π‡§æ‡§Å ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç',
                dragText: '‡§Ø‡§æ ‡§´‡•ã‡§ü‡•ã ‡§ï‡•ã ‡§Ø‡§π‡§æ‡§Å ‡§ñ‡•Ä‡§Ç‡§ö ‡§ï‡§∞ ‡§≤‡§æ‡§è‡§Ç',
                loading: '‡§Ü‡§™‡§ï‡•Ä ‡§ï‡§ø‡§∏‡•ç‡§Æ‡§§ ‡§ï‡•Ä ‡§∞‡•á‡§ñ‡§æ‡§è‡§Ç ‡§™‡§¢‡§º‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à‡§Ç...',
                analyzing: '‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',
                resultTitle: '‡§Ü‡§™‡§ï‡•Ä ‡§π‡§∏‡•ç‡§§‡§∞‡•á‡§ñ‡§æ ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£',
                footer: '‚ú® ‡§Ø‡§π ‡§ï‡•á‡§µ‡§≤ ‡§Æ‡§®‡•ã‡§∞‡§Ç‡§ú‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•à‡•§ ‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û ‡§∏‡•á ‡§∏‡§≤‡§æ‡§π ‡§≤‡•á‡§Ç‡•§',
                selectHand: '‡§ï‡•å‡§® ‡§∏‡§æ ‡§π‡§æ‡§•?',
                leftHand: '‡§¨‡§æ‡§Ø‡§æ‡§Ç ‡§π‡§æ‡§•',
                rightHand: '‡§¶‡§æ‡§Ø‡§æ‡§Ç ‡§π‡§æ‡§•',
                handTip: '‡§¨‡§æ‡§Ø‡§æ‡§Ç ‡§π‡§æ‡§• ‡§ú‡§®‡•ç‡§Æ‡§ú‡§æ‡§§ ‡§ó‡•Å‡§£ ‡§¶‡§ø‡§ñ‡§æ‡§§‡§æ ‡§π‡•à, ‡§¶‡§æ‡§Ø‡§æ‡§Ç ‡§π‡§æ‡§• ‡§Ö‡§∞‡•ç‡§ú‡§ø‡§§ ‡§ó‡•Å‡§£',
            },
            en: {
                title: 'Palm Reading Science',
                subtitle: 'Discover Your Destiny with AI',
                cameraTitle: 'Scan with Camera',
                cameraDesc: 'Place hand in front of camera',
                uploadTitle: 'Upload Photo',
                uploadDesc: 'Choose a palm photo',
                captureBtn: 'Capture Photo',
                analyzeBtn: 'Read Palm',
                cancelBtn: 'Cancel',
                resetBtn: 'Start Over',
                clickHere: 'Click Here',
                dragText: 'or drag photo here',
                loading: 'Reading your destiny...',
                analyzing: 'Analyzing...',
                resultTitle: 'Your Palm Reading',
                footer: '‚ú® Entertainment only. Consult experts for serious decisions.',
                selectHand: 'Which Hand?',
                leftHand: 'Left Hand',
                rightHand: 'Right Hand',
                handTip: 'Left: innate traits, Right: acquired traits',
            },
            hinglish: {
                title: '‡§π‡§∏‡•ç‡§§ ‡§∞‡•á‡§ñ‡§æ Science',
                subtitle: 'AI ke saath destiny discover karein',
                cameraTitle: 'Camera se Scan',
                cameraDesc: 'Haath camera ke saamne',
                uploadTitle: 'Photo Upload',
                uploadDesc: 'Palm photo choose karein',
                captureBtn: 'Photo Lo',
                analyzeBtn: 'Palm Read Karo',
                cancelBtn: 'Cancel',
                resetBtn: 'Phir se Start',
                clickHere: 'Yahan Click',
                dragText: 'ya photo drag karo',
                loading: 'Kismat ki lines read ho rahi hain...',
                analyzing: 'Analyze ho raha...',
                resultTitle: 'Aapki Palm Reading',
                footer: '‚ú® Entertainment ke liye. Important decisions ke liye expert se poochein.',
                selectHand: 'Kaunsa Haath?',
                leftHand: 'Left Hand',
                rightHand: 'Right Hand',
                handTip: 'Left: natural traits, Right: developed traits',
            }
        };

        // Prompts
        const getPrompt = (lang, hand) => {
            const handInfo = hand === 'left' 
                ? 'LEFT palm (natural/innate traits)' 
                : 'RIGHT palm (developed/acquired traits)';

            const prompts = {
                hi: `‡§Ü‡§™ ‡§π‡§∏‡•ç‡§§‡§∞‡•á‡§ñ‡§æ ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û ‡§π‡•à‡§Ç‡•§ ‡§Ø‡§π ${handInfo} ‡§π‡•à‡•§

‡§ó‡§π‡§® ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡•á‡§Ç:
1. ‡§ú‡•Ä‡§µ‡§® ‡§∞‡•á‡§ñ‡§æ - ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø, ‡§ú‡•Ä‡§µ‡§® ‡§∂‡§ï‡•ç‡§§‡§ø
2. ‡§π‡•É‡§¶‡§Ø ‡§∞‡•á‡§ñ‡§æ - ‡§™‡•ç‡§∞‡•á‡§Æ, ‡§≠‡§æ‡§µ‡§®‡§æ‡§è‡§Ç
3. ‡§Æ‡§∏‡•ç‡§§‡§ø‡§∑‡•ç‡§ï ‡§∞‡•á‡§ñ‡§æ - ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø, ‡§ï‡§∞‡§ø‡§Ø‡§∞
4. ‡§≠‡§æ‡§ó‡•ç‡§Ø ‡§∞‡•á‡§ñ‡§æ - ‡§∏‡§´‡§≤‡§§‡§æ, ‡§¶‡§ø‡§∂‡§æ

‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§: ‡§π‡§æ‡§• ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞, ‡§Æ‡§æ‡§â‡§Ç‡§ü‡•ç‡§∏, ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§ö‡§ø‡§®‡•ç‡§π

‡§∏‡§ï‡§æ‡§∞‡§æ‡§§‡•ç‡§Æ‡§ï ‡§î‡§∞ ‡§™‡•ç‡§∞‡•á‡§∞‡§ï ‡§∏‡§≤‡§æ‡§π ‡§¶‡•á‡§Ç‡•§ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç‡•§`,

                en: `You're a palm reading expert. This is the ${handInfo}.

Analyze comprehensively:
1. Life Line - Health, vitality
2. Heart Line - Love, emotions
3. Head Line - Intelligence, career
4. Fate Line - Success, direction

Additional: Hand shape, mounts, special marks

Provide positive, inspiring insights. In English.`,

                hinglish: `You're a palm expert. Yeh ${handInfo} hai.

Detailed analysis:
1. Life Line - Health, vitality
2. Heart Line - Love, emotions
3. Head Line - Intelligence, career
4. Fate Line - Success, direction

Extra: Haath ka shape, mounts, marks

Positive aur inspiring insights dein. Hinglish mein.`
            };

            return prompts[lang];
        };

        // Star Background Component
        const StarryBackground = () => {
            const stars = Array.from({ length: 50 }, (_, i) => ({
                id: i,
                left: Math.random() * 100,
                top: Math.random() * 100,
                delay: Math.random() * 3,
            }));

            return (
                <div className="fixed inset-0 pointer-events-none z-0">
                    {stars.map(star => (
                        <div
                            key={star.id}
                            className="absolute w-0.5 h-0.5 bg-mint rounded-full animate-twinkle"
                            style={{
                                left: `${star.left}%`,
                                top: `${star.top}%`,
                                animationDelay: `${star.delay}s`,
                            }}
                        />
                    ))}
                </div>
            );
        };

        // Language Selector
        const LanguageSelector = ({ currentLang, onLanguageChange }) => {
            const [isOpen, setIsOpen] = useState(false);

            const languages = [
                { code: 'hi', label: 'üáÆüá≥ ‡§π‡§ø‡§Ç‡§¶‡•Ä' },
                { code: 'en', label: 'üá¨üáß English' },
                { code: 'hinglish', label: 'üåê Hinglish' },
            ];

            const currentLangLabel = languages.find(l => l.code === currentLang)?.label;

            return (
                <div className="absolute top-8 right-8 z-50">
                    <button
                        onClick={() => setIsOpen(!isOpen)}
                        className="flex items-center gap-2 px-4 py-2 bg-secondary/80 backdrop-blur-lg border-2 border-mint rounded-full text-text hover:bg-mint/20 transition-all hover:-translate-y-0.5 hover:shadow-lg"
                        style={{ boxShadow: isOpen ? '0 4px 15px rgba(125, 211, 192, 0.3)' : 'none' }}
                    >
                        <Globe size={18} />
                        <span>{currentLangLabel}</span>
                        <span style={{ transform: isOpen ? 'rotate(180deg)' : 'rotate(0)', transition: 'transform 0.3s' }}>‚ñº</span>
                    </button>

                    {isOpen && (
                        <div className="absolute top-full right-0 mt-2 bg-secondary/90 backdrop-blur-xl border-2 border-mint rounded-2xl overflow-hidden min-w-[150px] animate-slideDown">
                            {languages.map(lang => (
                                <button
                                    key={lang.code}
                                    onClick={() => {
                                        onLanguageChange(lang.code);
                                        setIsOpen(false);
                                    }}
                                    className={`w-full px-4 py-3 text-left hover:bg-mint/15 transition-colors border-b border-mint/10 last:border-0 ${
                                        currentLang === lang.code ? 'bg-mint/20 text-mint font-semibold' : ''
                                    }`}
                                >
                                    {lang.label}
                                </button>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        // Hand Selector
        const HandSelector = ({ selectedHand, onHandSelect, t }) => {
            return (
                <div className="mb-6">
                    <p className="text-center text-text-dim mb-3">{t.selectHand}</p>
                    <div className="flex gap-4 justify-center">
                        <button
                            onClick={() => onHandSelect('left')}
                            className={`flex-1 max-w-[200px] p-4 rounded-xl border-2 transition-all ${
                                selectedHand === 'left'
                                    ? 'border-mint bg-mint/20 text-mint'
                                    : 'border-mint/30 hover:border-mint/50'
                            }`}
                        >
                            <div className="text-3xl mb-2">ü§ö</div>
                            <div className="font-semibold">{t.leftHand}</div>
                        </button>
                        <button
                            onClick={() => onHandSelect('right')}
                            className={`flex-1 max-w-[200px] p-4 rounded-xl border-2 transition-all ${
                                selectedHand === 'right'
                                    ? 'border-mint bg-mint/20 text-mint'
                                    : 'border-mint/30 hover:border-mint/50'
                            }`}
                        >
                            <div className="text-3xl mb-2">üñêÔ∏è</div>
                            <div className="font-semibold">{t.rightHand}</div>
                        </button>
                    </div>
                    <p className="text-center text-text-dim text-sm mt-3">{t.handTip}</p>
                </div>
            );
        };

        // Main App
        function PalmReadingApp() {
            const [language, setLanguage] = useState('hi');
            const [mode, setMode] = useState(null);
            const [selectedHand, setSelectedHand] = useState('right');
            const [image, setImage] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [result, setResult] = useState(null);
            const [isCameraActive, setIsCameraActive] = useState(false);
            
            const videoRef = useRef(null);
            const canvasRef = useRef(null);
            const streamRef = useRef(null);
            const fileInputRef = useRef(null);

            const t = translations[language];

            useEffect(() => {
                return () => {
                    if (streamRef.current) {
                        streamRef.current.getTracks().forEach(track => track.stop());
                    }
                };
            }, []);

            const startCamera = async () => {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({
                        video: { facingMode: 'user', width: 1280, height: 720 }
                    });
                    
                    if (videoRef.current) {
                        videoRef.current.srcObject = stream;
                        streamRef.current = stream;
                        setIsCameraActive(true);
                    }
                } catch (error) {
                    alert('Camera nahi mila. Photo upload karein.');
                    setMode(null);
                }
            };

            const stopCamera = () => {
                if (streamRef.current) {
                    streamRef.current.getTracks().forEach(track => track.stop());
                    streamRef.current = null;
                }
                setIsCameraActive(false);
                setMode(null);
            };

            const captureImage = () => {
                const video = videoRef.current;
                const canvas = canvasRef.current;
                
                if (video && canvas) {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(video, 0, 0);
                    
                    const imageData = canvas.toDataURL('image/jpeg', 0.9);
                    setImage(imageData);
                    stopCamera();
                }
            };

            const handleFileUpload = (file) => {
                if (file && file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        setImage(e.target.result);
                    };
                    reader.readAsDataURL(file);
                }
            };

            const analyzePalm = async () => {
                if (!image) return;

                setIsLoading(true);
                
                try {
                    const response = await fetch('https://api.anthropic.com/v1/messages', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: 'claude-sonnet-4-20250514',
                            max_tokens: 1500,
                            messages: [{
                                role: 'user',
                                content: [
                                    {
                                        type: 'image',
                                        source: {
                                            type: 'base64',
                                            media_type: 'image/jpeg',
                                            data: image.split(',')[1]
                                        }
                                    },
                                    {
                                        type: 'text',
                                        text: getPrompt(language, selectedHand)
                                    }
                                ]
                            }]
                        })
                    });

                    const data = await response.json();
                    
                    const resultText = data.content
                        .filter(item => item.type === 'text')
                        .map(item => item.text)
                        .join('\n');
                    
                    setResult(resultText);
                } catch (error) {
                    alert(`Error: ${error.message}`);
                } finally {
                    setIsLoading(false);
                }
            };

            const resetApp = () => {
                setMode(null);
                setImage(null);
                setResult(null);
                setIsCameraActive(false);
                stopCamera();
            };

            return (
                <div className="min-h-screen bg-primary text-text relative overflow-hidden">
                    <StarryBackground />
                    
                    <div className="fixed inset-0 pointer-events-none z-0">
                        <div className="absolute top-[20%] left-[20%] w-96 h-96 bg-mint/15 rounded-full blur-3xl" />
                        <div className="absolute bottom-[20%] right-[20%] w-96 h-96 bg-purple/12 rounded-full blur-3xl" />
                        <div className="absolute top-[50%] left-[50%] w-96 h-96 bg-blue/10 rounded-full blur-3xl" />
                    </div>

                    <LanguageSelector currentLang={language} onLanguageChange={setLanguage} />

                    <div className="container mx-auto px-4 py-8 relative z-10 max-w-5xl">
                        <header className="text-center py-12 animate-fadeIn">
                            <h1 className="text-5xl md:text-6xl font-bold mb-4 font-cinzel bg-gradient-text">
                                {t.title}
                            </h1>
                            <p className="text-xl text-text-dim">{t.subtitle}</p>
                        </header>

                        <div className="bg-secondary/70 backdrop-blur-xl border border-mint/30 rounded-3xl p-8 shadow-2xl animate-fadeIn">
                            <canvas ref={canvasRef} className="hidden" />
                            
                            {!mode && !result && (
                                <div className="grid md:grid-cols-2 gap-6 mb-6">
                                    <button
                                        onClick={() => {
                                            setMode('camera');
                                            startCamera();
                                        }}
                                        className="group relative bg-secondary/50 border-2 border-mint/40 rounded-2xl p-8 text-center transition-all hover:border-mint hover:-translate-y-2 overflow-hidden"
                                        style={{ boxShadow: '0 10px 30px rgba(125, 211, 192, 0)' }}
                                        onMouseEnter={(e) => e.currentTarget.style.boxShadow = '0 10px 30px rgba(125, 211, 192, 0.3)'}
                                        onMouseLeave={(e) => e.currentTarget.style.boxShadow = '0 10px 30px rgba(125, 211, 192, 0)'}
                                    >
                                        <Camera className="w-12 h-12 mx-auto mb-4 text-mint" />
                                        <h3 className="text-xl font-bold text-mint mb-2 font-cinzel">{t.cameraTitle}</h3>
                                        <p className="text-text-dim">{t.cameraDesc}</p>
                                    </button>

                                    <button
                                        onClick={() => setMode('upload')}
                                        className="group relative bg-secondary/50 border-2 border-purple/40 rounded-2xl p-8 text-center transition-all hover:border-purple hover:-translate-y-2 overflow-hidden"
                                        style={{ boxShadow: '0 10px 30px rgba(155, 127, 219, 0)' }}
                                        onMouseEnter={(e) => e.currentTarget.style.boxShadow = '0 10px 30px rgba(155, 127, 219, 0.3)'}
                                        onMouseLeave={(e) => e.currentTarget.style.boxShadow = '0 10px 30px rgba(155, 127, 219, 0)'}
                                    >
                                        <Upload className="w-12 h-12 mx-auto mb-4 text-purple" />
                                        <h3 className="text-xl font-bold text-purple mb-2 font-cinzel">{t.uploadTitle}</h3>
                                        <p className="text-text-dim">{t.uploadDesc}</p>
                                    </button>
                                </div>
                            )}
                            
                            {mode === 'camera' && isCameraActive && !image && (
                                <div className="space-y-4">
                                    <HandSelector selectedHand={selectedHand} onHandSelect={setSelectedHand} t={t} />
                                    
                                    <div className="relative rounded-2xl overflow-hidden border-2 border-mint shadow-xl">
                                        <video ref={videoRef} autoPlay playsInline className="w-full max-w-2xl mx-auto" />
                                    </div>
                                    
                                    <div className="flex gap-4 justify-center">
                                        <button
                                            onClick={captureImage}
                                            className="flex items-center gap-2 px-6 py-3 rounded-full text-primary font-semibold transition-all"
                                            style={{
                                                background: 'linear-gradient(135deg, #7DD3C0 0%, #60A5FA 100%)',
                                                boxShadow: '0 4px 15px rgba(125, 211, 192, 0.4)'
                                            }}
                                            onMouseEnter={(e) => {
                                                e.currentTarget.style.transform = 'translateY(-2px)';
                                                e.currentTarget.style.boxShadow = '0 6px 25px rgba(125, 211, 192, 0.6)';
                                            }}
                                            onMouseLeave={(e) => {
                                                e.currentTarget.style.transform = 'translateY(0)';
                                                e.currentTarget.style.boxShadow = '0 4px 15px rgba(125, 211, 192, 0.4)';
                                            }}
                                        >
                                            <Camera size={20} />
                                            {t.captureBtn}
                                        </button>
                                        <button
                                            onClick={stopCamera}
                                            className="flex items-center gap-2 px-6 py-3 border-2 border-mint text-mint rounded-full hover:bg-mint hover:text-primary transition-all"
                                        >
                                            <X size={20} />
                                            {t.cancelBtn}
                                        </button>
                                    </div>
                                </div>
                            )}
                            
                            {mode === 'upload' && !result && (
                                <div className="space-y-4">
                                    <HandSelector selectedHand={selectedHand} onHandSelect={setSelectedHand} t={t} />
                                    
                                    <input
                                        ref={fileInputRef}
                                        type="file"
                                        accept="image/*"
                                        onChange={(e) => handleFileUpload(e.target.files[0])}
                                        className="hidden"
                                    />
                                    
                                    {!image && (
                                        <div
                                            onClick={() => fileInputRef.current?.click()}
                                            onDragOver={(e) => e.preventDefault()}
                                            onDrop={(e) => {
                                                e.preventDefault();
                                                handleFileUpload(e.dataTransfer.files[0]);
                                            }}
                                            className="border-2 border-dashed border-mint rounded-2xl p-12 text-center cursor-pointer hover:border-purple hover:bg-purple/10 transition-all"
                                        >
                                            <Upload className="w-16 h-16 mx-auto mb-4 text-mint" />
                                            <p className="text-xl font-semibold text-mint mb-2">{t.clickHere}</p>
                                            <p className="text-text-dim">{t.dragText}</p>
                                        </div>
                                    )}

                                    {image && (
                                        <div className="space-y-4">
                                            <img src={image} alt="Palm" className="max-w-md mx-auto rounded-xl border-2 border-mint shadow-xl" />
                                            <div className="flex gap-4 justify-center">
                                                <button
                                                    onClick={analyzePalm}
                                                    disabled={isLoading}
                                                    className="flex items-center gap-2 px-6 py-3 rounded-full text-primary font-semibold transition-all disabled:opacity-50"
                                                    style={{
                                                        background: 'linear-gradient(135deg, #7DD3C0 0%, #60A5FA 100%)',
                                                        boxShadow: '0 4px 15px rgba(125, 211, 192, 0.4)'
                                                    }}
                                                    onMouseEnter={(e) => {
                                                        if (!isLoading) {
                                                            e.currentTarget.style.transform = 'translateY(-2px)';
                                                            e.currentTarget.style.boxShadow = '0 6px 25px rgba(125, 211, 192, 0.6)';
                                                        }
                                                    }}
                                                    onMouseLeave={(e) => {
                                                        e.currentTarget.style.transform = 'translateY(0)';
                                                        e.currentTarget.style.boxShadow = '0 4px 15px rgba(125, 211, 192, 0.4)';
                                                    }}
                                                >
                                                    <Sparkles size={20} />
                                                    {t.analyzeBtn}
                                                </button>
                                                <button
                                                    onClick={() => setImage(null)}
                                                    className="flex items-center gap-2 px-6 py-3 border-2 border-mint text-mint rounded-full hover:bg-mint hover:text-primary transition-all"
                                                >
                                                    <X size={20} />
                                                    {t.cancelBtn}
                                                </button>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}
                            
                            {image && !result && mode === 'camera' && (
                                <div className="space-y-4">
                                    <HandSelector selectedHand={selectedHand} onHandSelect={setSelectedHand} t={t} />
                                    <img src={image} alt="Captured Palm" className="max-w-md mx-auto rounded-xl border-2 border-mint shadow-xl" />
                                    <div className="flex gap-4 justify-center">
                                        <button
                                            onClick={analyzePalm}
                                            disabled={isLoading}
                                            className="flex items-center gap-2 px-6 py-3 rounded-full text-primary font-semibold transition-all"
                                            style={{
                                                background: 'linear-gradient(135deg, #7DD3C0 0%, #60A5FA 100%)',
                                                boxShadow: '0 4px 15px rgba(125, 211, 192, 0.4)'
                                            }}
                                        >
                                            <Sparkles size={20} />
                                            {t.analyzeBtn}
                                        </button>
                                        <button
                                            onClick={resetApp}
                                            className="flex items-center gap-2 px-6 py-3 border-2 border-mint text-mint rounded-full hover:bg-mint hover:text-primary transition-all"
                                        >
                                            <X size={20} />
                                            {t.cancelBtn}
                                        </button>
                                    </div>
                                </div>
                            )}
                            
                            {isLoading && (
                                <div className="text-center py-12">
                                    <Loader2 className="w-12 h-12 mx-auto mb-4 text-mint" />
                                    <p className="text-xl text-text">{t.analyzing}</p>
                                    <p className="text-text-dim mt-2">{t.loading}</p>
                                </div>
                            )}
                            
                            {result && (
                                <div className="space-y-6 animate-fadeIn">
                                    <div className="flex items-center gap-3 justify-center">
                                        <Sparkles className="text-mint" size={24} />
                                        <h2 className="text-2xl font-bold text-mint font-cinzel">{t.resultTitle}</h2>
                                        <Sparkles className="text-mint" size={24} />
                                    </div>
                                    
                                    {image && (
                                        <img src={image} alt="Analyzed" className="max-w-xs mx-auto rounded-xl border-2 border-mint/30 shadow-lg" />
                                    )}
                                    
                                    <div className="bg-secondary/70 backdrop-blur-sm border-l-4 border-mint rounded-xl p-6">
                                        <pre className="whitespace-pre-wrap text-text leading-relaxed font-spectral text-lg">
                                            {result}
                                        </pre>
                                    </div>
                                    
                                    <div className="flex justify-center">
                                        <button
                                            onClick={resetApp}
                                            className="flex items-center gap-2 px-8 py-3 rounded-full text-primary font-semibold transition-all"
                                            style={{
                                                background: 'linear-gradient(135deg, #7DD3C0 0%, #60A5FA 100%)',
                                                boxShadow: '0 4px 15px rgba(125, 211, 192, 0.4)'
                                            }}
                                            onMouseEnter={(e) => {
                                                e.currentTarget.style.transform = 'translateY(-2px)';
                                                e.currentTarget.style.boxShadow = '0 6px 25px rgba(125, 211, 192, 0.6)';
                                            }}
                                            onMouseLeave={(e) => {
                                                e.currentTarget.style.transform = 'translateY(0)';
                                                e.currentTarget.style.boxShadow = '0 4px 15px rgba(125, 211, 192, 0.4)';
                                            }}
                                        >
                                            <RotateCcw size={20} />
                                            {t.resetBtn}
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>

                        <footer className="text-center py-8 text-text-dim text-sm">
                            <p>{t.footer}</p>
                        </footer>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<PalmReadingApp />);
    </script>
</body>
</html>